<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Portfolio Nisrine Oulalite</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <header>
        <div class="header-menu">
            <a class="header-logo" href="index.html"><img src="logo.png" alt="logo"></a>
            <div class="header-menu-section">
                <ul>
                    <li><a class="animation" href="animation.html">Animation</a></li>
                    <li><a class="illustration" href="illustration.html">Illustration</a></li>
                    <li><a class="about" href="about.html">About</a></li>
                    <li><a class="contact" href="contact.html">Contact</a></li>
                </ul>
            </div>
            <div class="header-dropdown-menu">
                <img class="default-icon" src="icons/burger-bar.png" alt="dropdown menu">
            </div>
        </div>
    </header>
    <main>
        <div class="gallery-description-container">
            <div class="gallery-description">
                <h2 id="projectTitle"></h2>
                <p id="projectDescription"></p>
            </div>
        </div>
        <div class="gallery-container">
            <div class="main-image-container">
                <button class="nav-arrow" id="prevBtn"><img src="icons/previous.png" class="arrow" alt="previous"></button>
                <div class="main-image">
                    <img src="" class="image" id="mainImage" alt="Main Image">
                </div>
                <button class="nav-arrow" id="nextBtn"><img src="icons/next.png" class="arrow" alt="next"></button>
            </div>
            <div class="thumbnail-container">
                <div class="thumbnails" id="thumbnails"></div>
            </div>
        </div>
        <div id="zoomOverlay"></div>
    </main>
    <footer>
        <div class="footer-social-icons">
            <a href="https://www.instagram.com/onisrino?utm_source=ig_web_button_share_sheet&igsh=ZDNlZDc0MzIxNw==" target="_blank">
                <img class="icon" src="icons/instagram_icon.png" alt="Instagram">
            </a>
            <a href="https://vimeo.com/nisrine" target="_blank">
                <img class="icon" src="icons/vimeo_icon.png" alt="Vimeo">
            </a>
            <a href="https://www.linkedin.com/in/nisrineoulalite/" target="_blank">
                <img class="icon" src="icons/linkedin_icon.png" alt="LinkedIn">
            </a>
        </div>
        <p class="footer-copyright">
            © 2024 All rights reserved, all content are protected by copyright.
        </p>
    </footer>
    <style>
        /* Animation & Illustration gallery with navigation */

        #mainImage {
            cursor: zoom-in; /* Affiche une main pour indiquer que l'image est cliquable */
        }
        /* Classe pour l'image zoomée */
        .zoomed-image {
            position: absolute; /* Position absolue pour permettre le déplacement */
            pointer-events: none; /* Désactive les événements de souris sur l'image */
            z-index: 1000; /* Assure que l'image est au-dessus de tous les autres éléments */
            transition: transform 0.1s ease; /* Transition douce pour le déplacement de l'image */
            object-fit: contain;
        }

        /* Overlay pour l'effet de zoom */
        #zoomOverlay {
            display: none; /* Caché par défaut */
            position: fixed; /* Position fixe pour couvrir toute la fenêtre */
            top: 0;
            left: 0;
            width: 100vw; /* Couvre toute la largeur de la fenêtre */
            height: 100vh; /* Couvre toute la hauteur de la fenêtre */
            background: rgba(0, 0, 0, 0.7); /* Fond semi-transparent */
            z-index: 1000; /* Assure que l'overlay est au-dessus de tous les autres éléments */
            justify-content: center; /* Centre le contenu horizontalement */
            align-items: center; /* Centre le contenu verticalement */
            cursor: zoom-out;
        }

        .vimeo-container, .youtube-container {
            width: 100%;
            display: flex;
            justify-content: center;
            margin-bottom: 20px;
            /* border: 1px solid red; */
        }

        .vimeo-container iframe, .youtube-container iframe {
            width: 100%;
            height: 400px;
            background-color: black;
        }

        .gallery-container {
            display: flex;
            flex-direction: column;
            gap: 20px;
            /* border: 1px solid green; */

            .main-image-container {
                display: flex;
                gap: 50px;
                align-items: center;
                justify-content: center;
                
                /* img, button {
                    border: 1px solid red;
                } */
            }
            
            .main-image {
                display: flex;
                justify-content: center;
                width: 60%;
                height: 80vh;
                background: rgba(0, 0, 0, 0.1);
                /* border: 1px solid green; */
                
                img {
                    width: 100%; 
                    /* TODO: il faut mettre ça pr la responsivité */
                    object-fit: contain;
                }
            }
            
            .nav-arrow {
                border: none;
                cursor: pointer;
                padding: 0;
                width: 40px;
            }

            .arrow {
                width: 100%;
                background-color: #f2f2f2;
            }

            .nav-arrow {
                transition: opacity 0.3s ease-in-out, transform 0.3s ease-in-out;
            }
            
            .nav-arrow:hover {
                opacity: 0.7; 
                transform: scale(2.1);
            }

            .thumbnail-container {
                display: flex;
                justify-content: center;
                /* border: 1px solid green; */
            }

            .thumbnails {
                display: flex;
                justify-content: start;
                overflow-x: auto;
                width: 500px;
                white-space: nowrap;
            }
            
            .thumbnail {
                width: 100px;
                height: 70px;
                object-fit: cover;
                cursor: pointer;
                margin: 0 5px;
                border: 2px solid transparent;
                transition: border 0.5s;
            }
            
            .thumbnail:hover, .thumbnail.active {
                border: 2px solid #000000;
            }
        }

        .gallery-description-container {
            display: flex;
            justify-content: center;
            margin: 50px 0 50px 0;
            /* border: 1px solid green; */
            
            .gallery-description {
                display: flex;
                flex-direction: column;
                align-items: center;
                width: 80%;

                h2 {
                    margin: 0 0 30px 0;
                    /* border: 1px solid red; */
                }

                p {
                    margin: 0;
                    font-size: 18px;
                }
            }
        }
    </style>
    <script>
        // templating
        document.addEventListener('DOMContentLoaded', function() {
            // Fetch gallery data
            fetch('galleryData.json')
                .then(response => response.json())
                .then(data => {
                    const urlParams = new URLSearchParams(window.location.search);
                    const projectIndex = urlParams.get('project');

                    if (projectIndex !== null) {
                        const project = data[projectIndex];

                        document.getElementById('mainImage').src = project.mainImage;
                        document.getElementById('projectTitle').innerText = project.title;
                        document.getElementById('projectDescription').innerText = project.description;

                        // Add Vimeo video if vimeoLink is not empty
                        if (project.vimeoLink) {
                            const vimeoContainer = document.createElement('div');
                            vimeoContainer.classList.add('vimeo-container');
                            
                            vimeoContainer.innerHTML = `<iframe src="${project.vimeoLink}&title=0&byline=0&portrait=0" width="640" height="360" frameborder="0" allow="autoplay; fullscreen; picture-in-picture" allowfullscreen></iframe>`;
                            document.querySelector('main').insertBefore(vimeoContainer, document.querySelector('.gallery-description-container'));
                        }

                        // Add Youtube video if youtubeLink is not empty
                        if (project.youtubeLink) {
                            const youtubeContainer = document.createElement('div');
                            youtubeContainer.classList.add('youtube-container');

                            youtubeContainer.innerHTML = `<iframe width="560" height="315" src="${project.youtubeLink}" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen></iframe>`;
                            document.querySelector('main').insertBefore(youtubeContainer, document.querySelector('.gallery-description-container'));
                        }
                        
                        const thumbnails = document.getElementById('thumbnails');
                        thumbnails.innerHTML = '';
                        project.thumbnails.forEach((thumbnail, index) => {
                            const img = document.createElement('img');
                            img.src = thumbnail;
                            img.classList.add('thumbnail');
                            img.dataset.index = index;
                            img.alt = `Thumbnail ${index + 1}`;
                            thumbnails.appendChild(img);
                        });

                        // Adjust justify-content based on the number of thumbnails
                        if (project.thumbnails.length <= 5) {
                            thumbnails.style.justifyContent = 'center';
                        } else {
                            thumbnails.style.justifyContent = 'start';
                        }

                        /*-----------------------------*/
                        /* Animation & Illustration gallery with navigation arrows and thumbnail strip for quick navigation */

                        // Select the main image element
                        const mainImage = document.getElementById('mainImage');
                        // Select all thumbnail images
                        const thumbnailElements = document.querySelectorAll('.thumbnail');
                        // Select the previous button
                        const prevBtn = document.getElementById('prevBtn');
                        // Select the next button
                        const nextBtn = document.getElementById('nextBtn');
                        // Initialize the index of the currently displayed image to 0
                        let currentIndex = 0;

                        // Set the first thumbnail as active when the page loads
                        thumbnailElements[0].classList.add('active');

                        // Function to update the main image based on the index passed as an argument
                        function updateMainImage(index) {
                            // Update the source of the main image with that of the corresponding thumbnail
                            mainImage.src = thumbnailElements[index].src;
                            // Remove the 'active' class from the previous thumbnail
                            document.querySelector('.thumbnail.active').classList.remove('active');
                            // Add the 'active' class to the currently displayed thumbnail
                            thumbnailElements[index].classList.add('active');
                            // Update the index of the currently displayed image
                            currentIndex = index;
                        }

                        // Add event handler to each thumbnail
                        thumbnailElements.forEach((thumbnail, index) => {
                            // When a thumbnail is clicked, call the updateMainImage function with the index of that thumbnail
                            thumbnail.addEventListener('click', () => {
                                updateMainImage(index);
                            });
                        });

                        // Event handler for the 'previous' button
                        prevBtn.addEventListener('click', () => {
                            // Check if the current index is greater than 0 to avoid going below 0
                            if (currentIndex > 0) {
                                // Call the updateMainImage function with the decremented index to display the previous image
                                updateMainImage(currentIndex - 1);
                            }
                        });

                        // Event handler for the 'next' button
                        nextBtn.addEventListener('click', () => {
                            // Check if the current index is less than the length of thumbnails minus 1 to avoid exceeding the end
                            if (currentIndex < thumbnailElements.length - 1) {
                                // Call the updateMainImage function with the incremented index to display the next image
                                updateMainImage(currentIndex + 1);
                            }
                        });

                        /*-----------------------------*/
                        /* Zoom image on gallery navigation window */

                        const zoomOverlay = document.getElementById('zoomOverlay'); // Selects the zoom overlay
                        let zoomedImage = null; // Variable to store the zoomed image

                        mainImage.addEventListener('click', () => {
                            if (!zoomedImage) {
                                // If no image is currently zoomed
                                zoomedImage = document.createElement('img');
                                zoomedImage.classList.add('zoomed-image');
                                zoomedImage.src = mainImage.src;
                                zoomOverlay.appendChild(zoomedImage); // Adds the zoomed image to the overlay
                                zoomOverlay.style.display = 'flex'; // Displays the overlay

                                adjustZoomedImage(zoomedImage);

                                window.addEventListener('mousemove', onMouseMove); // Adds a mousemove event listener to the window
                                zoomOverlay.addEventListener('click', closeZoom);
                            } else {
                                closeZoom();
                            }
                        });

                        function adjustZoomedImage(img) {
                            const mainImageWidth = mainImage.offsetWidth; // Width of the main image
                            const mainImageHeight = mainImage.offsetHeight; // Height of the main image

                            img.style.width = `${mainImageWidth * 2}px`; // Sets the width of the zoomed image to twice the width of the main image
                            img.style.height = `${mainImageHeight * 2}px`; // Sets the height of the zoomed image to twice the height of the main image
                            img.style.left = '50%';
                            img.style.top = '50%';
                            img.style.transform = 'translate(-50%, -50%)'; // Centers the image
                        }

                        function onMouseMove(e) {
                            // Checks if an image is currently zoomed
                            if (zoomedImage) {
                                // Retrieves the horizontal and vertical coordinates of the mouse position relative to the window
                                const mouseX = e.clientX;
                                const mouseY = e.clientY;
                                
                                // Retrieves the width and height of the browser window
                                const windowWidth = window.innerWidth;
                                const windowHeight = window.innerHeight;
                                
                                // Retrieves the width and height of the zoomed image
                                const imgWidth = zoomedImage.offsetWidth; // Uses offsetWidth to get the computed width with CSS modifications
                                const imgHeight = zoomedImage.offsetHeight; // Uses offsetHeight to get the computed height with CSS modifications
                        
                                // Calculates the offset needed for the movement of the zoomed image
                                const offsetX = ((mouseX - windowWidth / 2) / windowWidth) * (imgWidth - windowWidth);
                                const offsetY = ((mouseY - windowHeight / 2) / windowHeight) * (imgHeight - windowHeight);
                        
                                // Applies the CSS transformation to move the zoomed image according to the mouse movement
                                zoomedImage.style.transform = `translate(calc(-50% + ${-offsetX}px), calc(-50% + ${-offsetY}px))`;
                            }
                        }
                        
                        function closeZoom() {
                            if (zoomedImage) {
                                zoomedImage.remove();
                                zoomedImage = null;
                                zoomOverlay.style.display = 'none';
                                window.removeEventListener('mousemove', onMouseMove); // Removes the mousemove event listener from the window
                                zoomOverlay.removeEventListener('click', closeZoom);
                            }
                        }
                    }
                })
                .catch(error => console.error('Error loading gallery data:', error));
        });
    </script>
</body>
</html>
